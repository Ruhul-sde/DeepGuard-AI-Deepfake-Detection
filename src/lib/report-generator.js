import jsPDF from 'jspdf';

export function generateReport(analysis) {
  const doc = new jsPDF();
  
  // Header with enhanced styling
  doc.setFontSize(24);
  doc.setTextColor(21, 101, 192); // Trust blue
  doc.text('DeepGuard AI Analysis Report', 20, 30);
  
  doc.setFontSize(12);
  doc.setTextColor(0, 0, 0);
  doc.text(`Generated: ${new Date().toLocaleString()}`, 20, 45);
  doc.text(`File: ${analysis.fileName}`, 20, 55);
  doc.text(`Analysis ID: ${analysis.id}`, 20, 65);
  
  // Executive Summary
  doc.setFontSize(18);
  doc.setTextColor(21, 101, 192);
  doc.text('Executive Summary', 20, 85);
  
  doc.setFontSize(12);
  doc.setTextColor(0, 0, 0);
  const statusColor = analysis.isManipulated ? [211, 47, 47] : [46, 125, 50];
  doc.setTextColor(...statusColor);
  doc.text(`Status: ${analysis.isManipulated ? 'MANIPULATED CONTENT DETECTED' : 'AUTHENTIC CONTENT VERIFIED'}`, 20, 100);
  doc.setTextColor(0, 0, 0);
  doc.text(`Overall Confidence: ${analysis.overallConfidence}%`, 20, 110);
  doc.text(`Risk Level: ${analysis.riskLevel}`, 20, 120);
  
  if (analysis.manipulationType) {
    doc.text(`Manipulation Type: ${analysis.manipulationType}`, 20, 130);
  }
  
  if (analysis.modelDetected) {
    doc.text(`AI Model Detected: ${analysis.modelDetected}`, 20, 140);
  }
  
  // Enhanced Technical Analysis
  doc.setFontSize(16);
  doc.setTextColor(21, 101, 192);
  doc.text('Technical Analysis Results', 20, 165);
  
  doc.setFontSize(12);
  doc.setTextColor(0, 0, 0);
  doc.text(`Facial Analysis Score: ${analysis.facialAnalysis}%`, 20, 180);
  doc.text(`Audio-Visual Synchronization: ${analysis.audioSyncAnalysis}%`, 20, 190);
  doc.text(`Compression Artifacts: ${analysis.artifactsAnalysis}%`, 20, 200);
  doc.text(`Temporal Consistency: ${analysis.temporalAnalysis}%`, 20, 210);
  
  if (analysis.voiceCloningScore) {
    doc.text(`Voice Cloning Detection: ${analysis.voiceCloningScore}%`, 20, 220);
  }
  if (analysis.lipSyncAccuracy) {
    doc.text(`Lip Sync Accuracy: ${analysis.lipSyncAccuracy}%`, 20, 230);
  }
  
  // AI Features (if available)
  if (analysis.aiFeatures) {
    doc.setFontSize(16);
    doc.setTextColor(21, 101, 192);
    doc.text('Advanced AI Analysis', 20, 250);
    
    doc.setFontSize(12);
    doc.setTextColor(0, 0, 0);
    doc.text(`Neural Network Layers: ${analysis.aiFeatures.neuralNetworkLayers}`, 20, 265);
    doc.text(`Model Ensemble Count: ${analysis.aiFeatures.modelEnsembleCount}`, 20, 275);
    doc.text(`Processing Time: ${analysis.aiFeatures.computeTime}s`, 20, 285);
  }
  
  // Footer with enhanced information
  doc.setFontSize(10);
  doc.setTextColor(100, 100, 100);
  doc.text('This report was generated by DeepGuard Advanced AI Detection System v2.1', 20, 280);
  doc.text('Â© 2024 DeepGuard. All rights reserved. ISO 27001 Certified.', 20, 290);
  
  // Download the PDF
  doc.save(`deepguard-analysis-${analysis.fileName}-${Date.now()}.pdf`);
}